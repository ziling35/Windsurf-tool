# 故障排除指南 (Troubleshooting Guide)

## 窗口崩溃问题修复

本次更新添加了以下改进来解决窗口意外终止的问题：

### 已实施的修复

1. **全局错误处理**
   - 添加了未捕获异常处理器
   - 添加了未处理的 Promise 拒绝处理器
   - 所有错误都会被记录到日志文件

2. **详细的错误日志**
   - 日志位置：`%APPDATA%\PaperCrane-Windsurf\logs\`
   - 日志文件名格式：`app-YYYY-MM-DD.log`
   - 记录所有关键操作和错误

3. **增强的错误监控**
   - 监控渲染进程崩溃
   - 监控页面加载失败
   - 监控控制台错误消息
   - 自动尝试恢复崩溃的窗口

4. **模块加载保护**
   - 所有核心模块加载都有错误处理
   - 启动失败时显示详细错误信息

5. **开发者工具**
   - 已启用 DevTools 用于调试
   - 按 F12 或 Ctrl+Shift+I 打开开发者工具

## 如何使用

### 1. 启动应用

运行 `start.bat` 或直接执行应用程序

### 2. 如果遇到问题

**查看日志文件：**

```
Windows: C:\Users\你的用户名\AppData\Roaming\PaperCrane-Windsurf\logs\
```

日志文件包含：
- 启动信息
- 错误详情
- 堆栈跟踪

### 3. 打开开发者工具

如果窗口可以打开但功能异常：
1. 按 `F12` 或 `Ctrl+Shift+I`
2. 查看 Console 标签页的错误信息
3. 截图并报告问题

## 常见问题

### 问题 1: 窗口立即关闭

**可能原因：**
- 依赖缺失
- 模块加载失败
- 权限问题

**解决方法：**
1. 检查日志文件
2. 重新安装依赖：`npm install`
3. 以管理员身份运行

### 问题 2: 页面加载失败

**可能原因：**
- HTML 文件路径错误
- 资源文件缺失

**解决方法：**
1. 确认 `renderer/index.html` 存在
2. 检查日志中的具体错误
3. 确保所有文件完整

### 问题 3: 渲染进程崩溃

**可能原因：**
- 内存不足
- GPU 加速问题
- 第三方库冲突

**解决方法：**
1. 查看日志文件中的 "render-process-gone" 消息
2. 尝试禁用硬件加速
3. 更新显卡驱动

### 问题 4: 模块加载错误

**错误消息示例：**
```
加载核心模块失败: Cannot find module 'xxx'
```

**解决方法：**
```bash
# 清理并重新安装依赖
rd /s /q node_modules
del package-lock.json
npm install
```

## 性能问题

### 应用启动慢

1. 检查是否在扫描 Windsurf 路径
2. 手动设置 Windsurf 路径避免自动扫描
3. 关闭不必要的后台程序

### 内存占用高

1. 检查是否有内存泄漏（查看开发者工具 Memory 标签）
2. 定期重启应用
3. 关闭不使用的标签页

## 获取帮助

如果问题仍未解决：

1. **收集信息：**
   - 日志文件内容
   - 错误截图
   - 系统信息（Windows 版本、内存等）
   - 操作步骤

2. **联系支持：**
   - 将上述信息整理后提供给开发者
   - 描述问题发生的具体情况

## 紧急恢复

如果应用完全无法使用：

1. **清理配置：**
   ```
   删除：%APPDATA%\PaperCrane-Windsurf\config.json
   ```

2. **重置应用：**
   ```bash
   # 重新安装
   npm install
   npm start
   ```

3. **检查 Windsurf 状态：**
   - 确保 Windsurf 已正确安装
   - 尝试手动运行 Windsurf 一次

## 日志级别说明

- **INFO**: 正常操作信息
- **WARN**: 警告，不影响主要功能
- **ERROR**: 错误，可能影响功能
- **RENDERER**: 渲染进程的消息

## 版本信息

当前版本包含的改进：
- ✅ 全局错误处理
- ✅ 详细日志记录
- ✅ 崩溃自动恢复
- ✅ DevTools 支持
- ✅ 增强的错误监控
